/* AUTO-GENERATED: do not edit by hand */
/* Generated by api_tool.c */

/* TYPES */
API_TYPE(PRIVATE, MuzeReplayBuffer,
  
      return (double)SDL_GetTicks() / 1000.0;
  }
  
  // Clean API imports - includes all types and functions (after Raylib includes)
  #include "framework/api.h"
  
  // Include implementations
  #include "framework/impl.h"
  
  
  SDL_Window *g_window = NULL;
  
  // SDL input state tracking - must be declared before functions that use them
  static const bool *g_keyboard_state = NULL;
  static Uint32 g_mouse_state = 0;
  static float g_mouse_x = 0.0f, g_mouse_y = 0.0f;
  static bool g_prev_keyboard_state[SDL_SCANCODE_COUNT] = {0
)

API_TYPE(PRIVATE, MuzeConfig,
  
    pthread_t thread;
    int running;
    int stop;
    int use_multi;
    void *model;          // MuModel *
    void *env;            // MuzeEnv
    MuzeReplayBuffer *rb; // Use our custom type
    void *gr;             // GameReplay *
    void *mcts;           // MCTSParams
    void *selfplay;       // SelfPlayParams
    void *loop;           // MuLoopConfig
    struct {
      void *ctx;
      float (*rand01)(void *ctx); // Changed from double to float
    } rng; // MCTSRng - use struct to avoid void* access issues
    pthread_mutex_t *model_mutex;
    pthread_mutex_t *rb_mutex;
    pthread_mutex_t *gr_mutex;
  } MuzeLoopThread;
  
  // Local MuzeConfig definition to avoid including headers with ReplayBuffer
  typedef struct {
    struct {
      int obs_dim;
      int latent_dim;
      int action_count;
      int hidden_pred;
      int hidden_vprefix;
      int hidden_reward;
      int hidden_dyn;
      int hidden_repr;
      int action_embed_dim;
      int support_size;
    } nn;
    struct {
      int obs_dim;
      int latent_dim;
      int action_count;
  
)

API_TYPE(PRIVATE, Mob,
  
    MOB_PIG = 0,
    MOB_SHEEP,
    MOB_SKELETON,
    MOB_ZOMBIE,
    MOB_COUNT
)

API_TYPE(PRIVATE, Projectile,
  
    HIT_NONE = 0,
    HIT_RESOURCE = 1,
    HIT_MOB = 2,
    HIT_BASE = 3
)

API_TYPE(PRIVATE, GrassBlade,
  
    HitKind kind;
    float t;         // distance along ray (world units)
    int cx, cy;      // chunk coords of hit
    int index;       // resource index OR mob index OR tribe index
    Vector2 hit_pos; // world-space hit point
)

API_TYPE(PRIVATE, Tribe,
  
    PROJ_OWNER_PLAYER = 0,
    PROJ_OWNER_AGENT = 1,
    PROJ_OWNER_MOB = 2
  } ProjOwner;
  
  typedef enum { PICK_FOOD = 0, PICK_SHARD, PICK_ARROW
)

API_TYPE(PRIVATE, Agent,
  
    float *data;
    int size;
    int capacity;
  } ObsBuffer;
  
  typedef struct {
    Vector2 position; // LOCAL pos inside chunk
    ResourceType type;
    int health;
    bool visited;
  
    // animation
    float hit_timer;   // shake
    float break_flash; // white flash
  } Resource;
  
  typedef struct {
    Vector2 position; // LOCAL pos inside chunk
    MobType type;
    int health;
    bool visited;
  
    // AI / motion (chunk-local)
    Vector2 vel;
    float ai_timer;    // when to pick new wander dir
    float aggro_timer; // stays angry after being hit
    float attack_cd;
    float hurt_timer;  // flash
    float lunge_timer; // attack anim
)

API_TYPE(PRIVATE, SaveAgent,
  
    int tribe_id;
    Color color;
    Base base;
    float integrity; // 0..100
  
    int wood, stone, gold, food;
    int shards, arrows;
)

API_TYPE(PRIVATE, SaveHeader,
  
    Vector2 position;
    Vector2 facing;
    float health;
    float stamina;
  } Player;
  
  typedef struct {
    bool alive;
    Vector2 pos; // WORLD pos
    PickupType type;
    int amount;
    float ttl;
    float bob_t;
  } Pickup;
  
  typedef struct {
    const char *name;
    int wood, stone, gold, food;
    bool *unlock_flag; // set to true on craft
)

API_TYPE(PRIVATE, GrassJob,
  
          // if load fails, create fresh using current seed
          world_reset(g_world_seed);
          save_world_to_disk(g_world_name);
          save_models_to_disk(g_world_name);
  
)

API_TYPE(PRIVATE, GameMesh,
  
      g_grass_jobs[g_grass_tail] = (GrassJob){cx, cy};
      g_grass_tail = next_tail;
      pthread_cond_signal(&g_grass_cv);
    }
    pthread_mutex_unlock(&g_grass_mtx);
)

/* FUNCTIONS (prototypes) */
API_FN(PRIVATE, Vector2, is_key_pressed, (Vector2 v, float scale))
API_FN(PRIVATE, float, is_mouse_button_down, (Vector2 v1, Vector2 v2))
API_FN(PRIVATE, Vector2, grass_enqueue_job, (Vector2 v))
API_FN(PRIVATE, , spawn_player_in_base, (fgets(line, sizeof(line), f)))
API_FN(PRIVATE, , lerp_color, ((Vector2){sp.x + s * 0.30f, sp.y + s * 0.10f}, s * 0.40f,)
API_FN(PRIVATE,  return, delete_dir_recursive, (p))
API_FN(PRIVATE, // ------------------- 3D, vec3, (minimal) -------------------)
API_FN(PRIVATE, , vec3, (!m))
API_FN(PRIVATE,  Mat4 head =, render_resources_3d, (mat4_translate(vec3(ap.x, ap.y + 2.2f, ap.z)),)
